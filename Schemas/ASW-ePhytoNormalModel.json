{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ASW E-Phyto Normal Status Schema (851) - Optimized Strict Version",
  "type": "object",
  "properties": {
    "xc_document": {
      "type": ["object", "null"],
      "properties": {
        "doc_name": { "type": ["string", "null"] },
        "doc_id": { "type": ["string", "integer", "null"] },
        "doc_description": { "type": ["string", "null"] },
        "doc_type": { "type": ["string", "integer"], "enum": ["851", 851] },
        "status_code": { "type": ["string", "integer"], "enum": ["70", 70] },
        "issue_date": { "type": ["string", "null"] },
        "issue_party_id": { "type": ["string", "integer", "null"] },
        "issue_party_name": { "type": ["string", "null"] },
        "include_notes": {
          "type": ["array", "null"],
          "items": {
            "type": "object",
            "properties": {
              "subject": { "type": ["string", "null"] },
              "contents": {
                "type": ["array", "null"],
                "items": {
                  "type": "object",
                  "properties": { "content": { "type": ["string", "integer", "null"] } }
                }
              }
            },
            "required": ["subject", "contents"],
            "allOf": [
              {
                "if": { "properties": { "subject": { "enum": ["SPSFL", "DMCL"] } } },
                "then": { "properties": { "contents": { "maxItems": 1 } } }
              }
            ]
          }
        },
        "reference_docs": {
          "type": ["array", "null"],
          "items": {
            "type": "object",
            "properties": {
              "type_code": { "type": ["string", "integer", "null"], "enum": ["851", 851, "657", 657, null] },
              "relation_type_code": { "type": ["string", "null"] },
              "doc_id": { "type": ["string", "integer", "null"] },
              "PdfObject": { "type": ["string", "null"] },
              "filename": { "type": ["string", "null"] }
            }
          }
        },
        "signatory_authen": {
          "type": ["object", "null"],
          "properties": {
            "actual_datetime": { "type": ["string", "null"] },
            "issue_location": { "type": ["object", "string", "null"] },
            "provider_party": { "type": ["object", "null"] },
            "include_clauses": {
              "type": ["array", "null"],
              "items": {
                "type": "object",
                "properties": {
                  "id": { "type": ["string", "integer", "null"] },
                  "content": { "type": ["string", "null"] }
                }
              }
            }
          }
        }
      },
      "required": ["doc_id", "doc_type", "status_code"]
    },
    "consignment": {
      "type": ["object", "null"],
      "properties": {
        "consignor_party": { "type": ["object", "null"] },
        "consignee_party": { "type": ["object", "null"] },
        "export_country": { "type": ["object", "null"] },
        "import_country": { "type": ["object", "null"] },
        "examination_event": {
          "type": ["object", "null"],
          "properties": { "occur_location_name": { "type": ["string", "null"] } }
        }
      }
    },
    "items": {
      "type": ["array", "null"],
      "items": {
        "type": "object",
        "properties": {
          "sequence_no": { "type": ["string", "integer", "null"] },
          "descriptions": { "type": ["array", "null"] },
          "intend_uses": { "type": ["array", "null"] },
          "net_weight": {
            "type": ["object", "null"],
            "properties": { "weight": { "type": ["string", "number", "null"] }, "unit_code": { "type": ["string", "null"] } }
          },
          "gross_weight": {
            "type": ["object", "null"],
            "properties": { "weight": { "type": ["string", "number", "null"] }, "unit_code": { "type": ["string", "null"] } }
          },
          "net_volume": { "type": ["object", "null"] },
          "gross_volume": { "type": ["object", "null"] },
          "additional_notes": {
            "type": ["array", "null"],
            "items": {
              "type": "object",
              "properties": {
                "subject": { "type": ["string", "null"] },
                "contents": { "type": ["array", "null"] }
              },
              "allOf": [
                {
                  "if": { "properties": { "subject": { "enum": ["OPTND", "OQV", "OQU", "ADIPTLIL", "ADDITLIL"] } } },
                  "then": { "properties": { "contents": { "maxItems": 1 } } }
                }
              ]
            }
          },
          "applicable_classifications": {
            "type": ["array", "null"],
            "items": {
              "type": "object",
              "properties": {
                "system_name": { "type": ["string", "null"] },
                "class_names": { "type": ["array", "null"] }
              },
              "allOf": [
                {
                  "if": { "properties": { "system_name": { "const": "HS" } } },
                  "then": { "properties": { "class_names": { "maxItems": 1 } } }
                }
              ]
            }
          },
          "physical_packages": { "type": ["array", "null"] },
          "origin_countries": { "type": ["array", "null"] },
          "applied_processes": {
            "type": ["array", "null"],
            "items": {
              "type": "object",
              "properties": {
                "type_code": { "type": ["string", "integer", "null"] },
                "complete_period": { "type": ["object", "null"] },
                "characteristics": { "type": ["array", "null"] }
              }
            }
          }
        }
      }
    }
  },
  "required": ["xc_document", "consignment", "items"]
}
